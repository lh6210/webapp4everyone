<?php
require_once 'pdo.php';
?>


<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title></title>
	<!-- import jquery library -->
	<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
	<style>
	input[type=text] {
		width: 30em;
	}
	textarea {
		display: block;
		width: 31em;
	}
	button {
		color: white;
		background-color:#4CAF50;
		font-size:1em;
	}
	
	</style>
</head>
<body>
	<form id='posList'>
		<span>Positions:
		<input type="button" id='addBtn' value='+'>
		</span>
		<!--
		<div id="posList"></div>
		-->
		<input type="submit" id='submitBtn' value='Submit'>
  </form>

	<p id='cnt'></p>
  <p id='warning'></p>

	<script>
		var maxCnt = 5;
    var cnt = 0; // later

    // click addBtn will trigger addPosBox function
    document.querySelector('#addBtn').addEventListener('click', addPosBox);
    
    function addPosBox() {
      // check current position box number 
      // let cnt = checkCnt();
      if (cnt < maxCnt) {
        //let elm = "<div><input type='text' name='position'+cnt><input type='button' value='-' class='delBtns'></div>";
        let container = document.createElement('div');
        //let st = 'position' + toString(cnt);
				// input box
        let inputTxt = document.createElement('input');
        inputTxt.setAttribute('type', 'text');
				// delete button and its eventListener
        let inputBtn = document.createElement('button');
        inputBtn.setAttribute('type', 'button');
        inputBtn.innerHTML = '-';
        inputBtn.addEventListener('click', delPosBox);
				let inputTextArea = document.createElement('textarea');
				inputTextArea.setAttribute('rows', 5);
				// append these nodes to the container
        container.append(inputTxt);
        container.append(inputBtn);
        container.append(inputTextArea);

				// append the container to the position list
        $('#posList').append(container);
				// update the # of positions
        cnt++;
				// update position information slot
				updateCnt(cnt);
      } else {
        alert("You've reached the maximum position numbers.");
      }
    }
    
    function delPosBox() {
      this.parentElement.remove(); 
      cnt--;
			updateCnt(cnt);
    }

		function updateCnt(cnt) {
			let c = document.querySelector('#cnt');
			c.innerHTML = "position number: " + cnt;
		}


		document.querySelector('form').onsubmit = checkChildren;

		function checkChildren(e){
			e.preventDefault();	
			let x = document.querySelector('form').children;
			for (let i of x) {
				console.log(i);
		}
		}

		function submitForm(){
			//data validation
			let data = new FormData(document.querySelector('form'));

			//let itr = data.entries();
			alert(JSON.stringify(Object.fromEntries(data)));
			console.log(data);

		}



		/* no more needed code

		// $.add() test
		$(document).ready(function() {
			//$('p').add('div').css('background-color', 'yellow');
			$('p, div').css('background-color','yellow');
		});

    // minus one because the first child of posList is the input button '+' 
    function checkCnt() {
      let cnt =document.querySelector('#posList').children;
      console.log('the # of position boxes: ' + (cnt.length - 1));
      return cnt.length;
    }

    // add eventListeners to a certain existing class 
    const buttons = document.getElementsByClassName('delBtns');
    for (const button of buttons) {
      button.addEventListener('click', delPosBox);
    }
		*/
	</script>
</body>
</html>
