<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Array Comparison with numbers</title>
    <!-- bootstrap CDN-->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <!-- self-made stylesheet -->
    <link rel="stylesheet" href="../assets/styles/style.css">
    <!-- code block -->
    <link rel="stylesheet" href="../assets/styles/prism.css">
    <!-- icon --> 
    <script src="https://kit.fontawesome.com/cbc558647c.js" crossorigin="anonymous"></script>
    <link rel="icon" href="../assets/icons/feather-alt-solid.svg">
  </head>
  <body class='language-python line-numbers'>
    <div class='container'>
      <div class="row header">
	<div class="col-12 d-flex align-items-center flex-wrap">
	  <div class='h-elm'> &#9730 </div>
	  <div class='h-elm'> &#9728 </div>
	  <div class='h-elm'>&#9731</div>
	  <div class='h-elm'>&#9998</div>
	  <div class='h-elm'>&#9822</div>
	  <div class='h-elm'>&#9825</div>
	  <div class='h-elm'> &#9836 </div>
	  <div class='h-elm'> &#9743 </div>
	  <i class="fas fa-dog fa-sm h-elm"></i>
	  <i class="fas fa-cat fa-sm h-elm"></i>
	</div>
      </div>

      <div class="row main">
	<div class='col'>
	  <h1>2.4.11/12 Implementing Linked List and Dictionary(2)</h1>
	  <p>Nov 8, 2020</p>
	  <hr>
	  <p>Announcement: most of the code here is directly copied from <a href='http://composingprograms.com/pages/24-mutable-data.html#implementing-lists-and-dictionaries'>John DeNero's CS61A</a>. The purpose of this article is to reinforce my understanding by sharing my experience and to hopefully help others smooth out any minor obstacles in their study process. Any section I mentioned in this article refers to the section on John DeNero's CS61A. I might also use 'the book' to refer to CS61A.</p>
	  <p>In the second part, the book teaches us how to implement a dictionary with its own internal state.</p>
	  <p>Let's open a new file and write the code in. It's from section 2.4.11.</p>
	  <pre><code>
	  def dictionary():
	      """Return a functional implementation of a dictionary"""
	      records = []
	      def getitem(key):
		  for elm in records:
		      if elm[0] == key:
			  return elm[1]
		  return 'Not found'
	      
	      def setitem(key, value):
		  nonlocal records
		  non_match = [elm for elm in records if elm[0] != key]
		  records = non_match + [[key, value]]

	      def dispatch(message, key=None, value=None):
		  if message == 'getitem':
		      return getitem(key)
		  elif message == 'setitem':
		      setitem(key, value)
	      return dispatch
	  </code></pre>   

	  <p></p>
	  <p></p>
	  <pre class='command-line no-line-numbers' data-prompt=">>>" data-filter-output="(out)"><code>
	  d = dictionary()
	  d
	  (out)<\function dictionary.<\locals>.dispatch at 0x0000020E62650430>
	  d('getitem', 0) # right now the records in the dictionary has nothing in it 
	  (out)'Not found'
	  d('setitem', 'color', 'green') # I am going to add some key-value pairs into records
	  d('setitem', 'drink', 'coffee')
	  d('setitem', 'weather', 'cloudy')
	  d('getitem', 'drink')
	  (out)'coffee'
	  </code></pre>

	  <p>These are the contents in section 2.4.11 -- implementing linked lists and dictionaries. The key concepts covered are internal state, message passing interface with dispatch functions. What's more interesting is in section 2.4.12, where the book switches from using conditional statements in dispatch functions to using Python's built-in dictionary data type.</p>
	  <p>Let's see the implementation:</p>
	  <pre><code>
	  def account(initial_balance):        # higher-order function again
	      def deposit(amount):
		  dispatch['balance'] += amount
		  return dispatch['balance']
	      def withdraw(amount):
		  if amount > dispatch['balance']:
		      return 'Insufficient funds'
		  dispatch['balance'] -= amount
		  return dispatch['balance']
	      dispatch = {'deposit': deposit,          # Python's built-in dictionary
			  'withdraw': withdraw,
			  'balance': initial_balance}   # internal state(initial_balance) is stored in one of the key-value pairs
	      return dispatch

	      def withdraw(accountInstance, amount):
		  return accountInstance['withdraw'](amount)

	      def deposit(accountInstance, amount):
		  return accountInstance['deposit'](amount)

	      def check_balance(accountInstance):
		  return accountInstance['balance']
	  </code></pre>
	  <pre class='command-line no-line-numbers' data-prompt=">>>" data-filter-output="(out)"><code>
	  tom_account = account(39) # construct tom_account
	  tom_account  # it looks like tom_account is a dictionary
	  (out){'deposit': <\function account.<\locals>.deposit at 0x0000020E62650280>, 'withdraw': <\function account.<\locals>.withdraw at 0x0000020E62650160>, 'balance': 39}
	  a['deposit'](2) # then we could directly operate on the dictionary like this
	  (out)41
	  a['withdraw'](42)
	  (out)'Insufficient funds'
	  a['withdraw'](11)
	  (out)30

	  withdraw(tom_account 5) # or we could use the function defined in our code above
	  25
	  deposit(tom_account 10)
	  35
	  check_balance(a)
	  35
	  </code></pre>   
	  <p>I feel the dictionary approach is very neat. Let's rewrite the previous part in this way.</p>
	</div>  <!-- col ends-->
      </div>  <!--row main ends -->

      <!--footer row begins-->
      <div class="row footer">
	<div class="col-12 d-flex justify-content-around align-items-center flex-wrap">
	  <a href="../index.html"><i class="fas fa-helicopter"></i> Index page</a>
	  <div>&copy; 2020 PeterLearns2Code<i class="fas fa-feather-alt"></i></div>
	  <div>Email: lh6210@gmail.com</div>
	  <div><a href="https://twitter.com/PeterLi06"><i class="fab fa-twitter-square fa-2x"></i></a></div>
	</div>
      </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
    <script src='sort.js'></script>
    <script src='../assets/styles/prism.js'></script>
  </body>
</html>
